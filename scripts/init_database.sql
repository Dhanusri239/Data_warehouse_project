--CREATE DATABASE AND SCHEMAS
--THE PURPOSE IS TO CREATE DATABASE AND SCHEMAS FOR DATAWAREHOUSE PROJECT
--==================================================================================================================
--step 1:switch to master
--==================================================================================================================
USE master;
GO
--==================================================================================================================
--step 2:checking existence
--==================================================================================================================
IF EXISTS(SELECT 1 FROM sys.databases WHERE name= 'DataWarehouse')
BEGIN
    ALTER DATABASE DataWarehouse SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
	DROP DATABASE DataWarehouse;
END
--==================================================================================================================
--step 3:create new database 
--==================================================================================================================
CREATE DATABASE DataWarehouse;
GO
--==================================================================================================================
--step 4:switch to our new database
--==================================================================================================================
USE DataWarehouse;
GO
--==================================================================================================================
--step 5:creating schemas for our database
--==================================================================================================================
CREATE SCHEMA bronze;
GO
CREATE SCHEMA silver;
GO
CREATE SCHEMA gold;
GO
